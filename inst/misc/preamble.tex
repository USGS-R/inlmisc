% Typography
\usepackage[T1]{fontenc}          % font encoding
\usepackage{mathptmx}             % define Times as default text font
\usepackage{amsfonts}             % load American Mathematical Society fonts
\usepackage[scaled=0.92]{helvet}  % load Helvetica font scaled so that it matches Times font
\usepackage{textcomp}             % load Text Companion fonts

\usepackage[tmargin=1.00in, bmargin=0.67in, lmargin=0.58in, rmargin=0.75in]{geometry} % document dimensions
\usepackage[pdftex]{lscape}  % place selected parts of a document in landscape

\usepackage{url}          % verbatim with url-sensitive line breaks
\usepackage[backend=bibtex, style=authoryear-comp, maxbibnames=99, maxcitenames=3, natbib=true, dashed=false]{biblatex}  % bibliographic facilities
\usepackage{xpatch}       % macro patching commands
\usepackage{xcolor}       % color extensions
\usepackage{ragged2e}     % set ragged text
\usepackage{caption}      % customise captions in floating environments
\usepackage{subcaption}   % support for sub-captions
\usepackage{verbatimbox}  % deposit verbatim text in a box
\usepackage{titling}      % control over the typesetting of the \maketitle command
\usepackage{booktabs}     % enhances tables
\usepackage{dcolumn}      % align on the decimal point of numbers in tabular columns
\usepackage{tabularx}     % tabulars with adjustable-width columns
\usepackage{makecell}     % tabular column heads and multilined cells
\usepackage{array}        % extends the array and tabular environments
\usepackage{enumitem}     % control layout of itemize, enumerate, description
\usepackage{amsmath}      % American Mathematical Society mathematical facilities
\usepackage{bm}           % access bold symbols in math mode
\usepackage{xfrac}        % typset fractions
\usepackage{tocloft}      % control Table of Contents, List of Figures, and List of Tables
\usepackage{sectsty}      % control sectional headers
\usepackage{fancyhdr}     % control page headers and footers
\usepackage{indentfirst}  % indent first paragraph after section header

\usepackage[hidelinks, pdflang={en-US}]{hyperref}  % support for hypertext links

% bibliography

\DefineBibliographyStrings{english}{andothers={and~others}}
\setlength{\bibitemsep}{\baselineskip}

\DeclareFieldFormat{title}{#1}
\DeclareFieldFormat[article,thesis,report,incollection,inproceedings,misc]{title}{#1}
\DeclareFieldFormat[incollection,inproceedings]{booktitle}{#1}

\DeclareNameAlias{sortname}{last-first}
\DeclareNameAlias{default}{last-first}

\DefineBibliographyStrings{english}{page={p\adddot}, pages={p\adddot}}
\DefineBibliographyStrings{english}{references={References Cited}}

\renewcommand*{\newunitpunct}{\addcomma\space}
\renewcommand*{\intitlepunct}{\space}

\DeclareFieldFormat[article]{volume}{v.\addnbspace #1}
\DeclareFieldFormat[article]{number}{no.\addnbspace #1}

\DeclareFieldFormat[article]{journaltitle}{#1}

\renewbibmacro*{volume+number+eid}{%
  \printfield{volume}%
  \setunit{\addcomma\space}%
  \printfield{number}%
  \setunit{\addcomma\space}%
  \printfield{eid}}

\renewbibmacro*{journal+issuetitle}{%
  \usebibmacro{journal}%
  \setunit*{\addcomma\space}%
  \iffieldundef{series}
    {}
    {\newunit
     \printfield{series}%
     \setunit{\addcomma\space}}%
  \usebibmacro{volume+number+eid}%
  \setunit{\addspace}%
  \usebibmacro{issue+date}%
  \setunit{\addcolon\space}%
  \usebibmacro{issue}%
  \newunit}


\xpatchbibmacro{date+extrayear}{%
  \printtext[parens]%
}{%
  \setunit*{\addcomma\space}%
  \printtext%
}{}{}

% maketitle

\pretitle{\begin{flushleft}\LARGE\bfseries\sffamily}
\posttitle{\end{flushleft}\vspace{2ex}}
\preauthor{\begin{flushleft}\large\sffamily}
\postauthor{\par\end{flushleft}}
\predate{}
\date{}
\postdate{}

%

\pagestyle{fancy}
\renewcommand{\sectionmark}[1]{\markboth{#1}{}}
\renewcommand{\headrulewidth}{0pt}
\fancyhf{}
\fancypagestyle{plain}{
  \fancyhf{}
  \fancyhead[RO]{\normalfont\bfseries\sffamily \thepage}
}
\fancyhead[LE]{\normalfont\bfseries\sffamily \thepage \quad Report Title}
\fancyhead[RO]{\normalfont\bfseries\sffamily \nouppercase{\leftmark} \quad \thepage}

\sectionfont{\Large\bfseries\sffamily}
\subsectionfont{\large\bfseries\sffamily}
\subsubsectionfont{\large\mdseries\sffamily}

\renewcommand\refname{References Cited}
\renewcommand\cftsecfont{\sffamily}
\renewcommand\cftsubsecfont{\sffamily}
\renewcommand\cftsubsubsecfont{\sffamily}
\renewcommand\cfttoctitlefont{\Large\bfseries\sffamily}
\renewcommand\cftloftitlefont{\Large\bfseries\sffamily}
\renewcommand\cftlottitlefont{\Large\bfseries\sffamily}
\renewcommand{\cftdotsep}{0.5}
\renewcommand\cftsecleader{\cftdotfill{\cftdotsep}}

\renewcommand\cftsecpagefont{\normalfont}

\setlength{\cftfignumwidth}{2.55em}
\renewcommand\cftfigaftersnum{. }
\renewcommand\cfttabaftersnum{. }

\setlength{\cftbeforesecskip}{0.1cm}
\setlength{\cftbeforesubsecskip}{0.1cm}
\setlength{\cftbeforesubsubsecskip}{0.1cm}
\setlength{\cftbeforefigskip}{0.1cm}
\setlength{\cftbeforetabskip}{0.1cm}

\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\renewcommand{\sfdefault}{lmss}
\renewcommand{\ttdefault}{lmtt}

\renewcommand*\descriptionlabel[1]{\hspace\leftmargin$#1$}

\definecolor{Red}{rgb}{0.7,0,0}
\definecolor{Blue}{rgb}{0,0,0.8}
\hypersetup{colorlinks, urlcolor={Red}, linkcolor={Blue}, citecolor={Blue}, linktoc=page}

\captionsetup[figure]{skip=5pt}
\captionsetup{labelsep=period, labelfont=bf}
\captionsetup[subfigure]{skip=-5pt, labelfont={bf,it}}
\renewcommand{\thesubfigure}{\Alph{subfigure}}

\newcommand{\R}{{\normalfont\textsf{R}}{}}

\widowpenalties 1 10000
\raggedbottom

% paragraph

\renewenvironment{knitrout}{\setlength{\topsep}{0mm}}{}
\setlength\RaggedRightParindent{15pt}

\makeatletter
\setlength{\@fptop}{0pt}
\setlength{\@fpbot}{0pt plus 1fil}
\makeatother

\setcounter{secnumdepth}{0}
